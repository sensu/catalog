## Overview

<!-- Sensu Integration description; supports markdown -->

The AWS RDS Monitoring integration collects [Amazon Relational Database Service] (Amazon RDS) metrics from [AWS CloudWatch] and sends alerts for various RDS conditions.

<!-- Provide a high level overview of the integration contents (e.g. checks, filters, mutators, handlers, assets, etc) -->

This integration includes the following Sensu resources:

* `aws-{AWS_REGION}-rds-metrics` [check]
* `sensu/sensu-cloudwatch-check:0.3.0` [asset] 

## Dashboards

<!-- List of compatible dashboards w/ screenshots (supports png, jpeg, and gif images; relative paths only; e.g. `![](img/dashboard-1.png)` )-->

<!-- This integration is compatible with the [{{dashboard_name}}][{{dashboard_link}}] (included w/ [Sensu Plus][sensu-plus]). -->

<!-- ![](img/dashboard.png) -->

The AWS RDS Monitoring integration does not have compatible dashboards.

## Setup

1. Confirm that you have access to [AWS CloudWatch APIs].
   
   The AWS RDS Monitoring integration requires read-only access to AWS CloudWatch (e.g. `arn:aws:iam::aws:policy/CloudWatchReadOnlyAccess`).

1. Get AWS authentication credentials.
   
   The AWS RDS Monitoring integration accepts all forms of AWS authentication supported by the [AWS CLI]:

   - AWS credential profile
   - AWS access key ID + AWS secret access key
   - [EC2 IAM instance profile]

   Avoid providing an AWS credential profile, access key ID, or secret access key in production environments. We suggest an alternative form of AWS authentication, such as EC2 IAM instance profiles.

   If the check from this integration will run on a Sensu agent installed on an EC2 instance whose EC2 IAM instance profile contains `arn:aws:iam::aws:policy/CloudWatchReadOnlyAccess`, you do not need to provide an AWS credential profile, access key ID, or secret access key.

   **Optional**: If you want to use Sensu [secrets] to represent the AWS profile name, access key ID, or secret access key, you will need the secret names when you install this integration.

1. Decide which Sensu agents should execute the `aws-{AWS_REGION}-RDS-metrics` check. You will need the agent subscription names when you install this integration.

1. If you want to use a Sensu [pipeline] to process AWS RDS Monitoring integration data, you will need the pipeline names when you install this integration.

   You can configure separate pipelines for alerts, incident management, and metrics.

## Plugins

<!-- Links to any Sensu Integration dependencies (i.e. Sensu Plugins) -->

The AWS RDS Monitoring integration uses the following Sensu [plugins]:

- [sensu/sensu-cloudwatch-check][sensu-cloudwatch-check-bonsai] ([GitHub][sensu-cloudwatch-check-github])

## Alerts

<!-- List of all alerts generated by this integration. -->

The AWS RDS Monitoring integration produces the following events that should be processed by an alert or incident management pipeline:

**CPUUtilizationMaximum**

- Generates a WARNING event when CPU utilization percentage is greater than a user-configurable maximum value (default 80)
- Generates a CRITICAL event when CPU utilization percentage is greater than a user-configurable maximum value (default 90)

## Metrics

<!-- List of all metrics or events collected by this integration. -->

The AWS RDS Monitoring integration collects CloudWatch Amazon RDS metrics (i.e. `AWS/RDS` metrics), which are listed in the table below. For a description of each metric, read [Amazon CloudWatch metrics for Amazon RDS].

Metric name | Tags
----------- | ----
`aws_rds_cpu_utilization_average` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_cpu_utilization_maximum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_cpu_utilization_minimum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_freeable_memory_average` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_freeable_memory_maximum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_freeable_memory_minimum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_free_strorage_space_average` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_free_strorage_space_maximum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`
`aws_rds_free_strorage_space_minimum` | `DBInstanceIdentifier`, `DatabaseClass`, `EngineName`, `SourceRegion`

## Reference Documentation

<!-- Please provide links to any relevant reference documentation to help users learn more and/or troubleshoot this integration; specifically including any third-party software documentation. -->

* [Token substitution] (Sensu documentation): the AWS RDS Monitoring integration supports Sensu tokens for variable substitution with data from Sensu entities
* [Amazon RDS][Amazon Relational Database Service] (AWS documentation)
* [Amazon CloudWatch API Reference][AWS CloudWatch APIs] (AWS documentation)
* [Overview of monitoring metrics in Amazon RDS] (AWS documentation)


<!-- Links -->
[check]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/checks/
[asset]: https://docs.sensu.io/sensu-go/latest/plugins/assets/
[subscription]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/subscriptions/
[subscriptions]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/subscriptions/
[agents]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/agent/
[annotation]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/agent/#general-configuration-flags
[plugins]: https://docs.sensu.io/sensu-go/latest/plugins/
[metrics]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/metrics/
[handler]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-process/handlers/
[pipeline]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-process/pipelines/
[secret]: https://docs.sensu.io/sensu-go/latest/operations/manage-secrets/secrets/
[secrets]: https://docs.sensu.io/sensu-go/latest/operations/manage-secrets/secrets/
[Token substitution]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/tokens/
[sensu-plus]: https://sensu.io/features/analytics
[{{dashboard-link}}]: #
[sensu-cloudwatch-check-bonsai]: https://bonsai.sensu.io/assets/sensu/sensu-cloudwatch-check
[sensu-cloudwatch-check-github]: https://github.com/sensu/sensu-cloudwatch-check
[Amazon Relational Database Service]: https://aws.amazon.com/rds/
[AWS CloudWatch]: https://aws.amazon.com/cloudwatch/
[AWS CLI]: https://aws.amazon.com/cli/
[EC2 IAM instance profile]: https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html
[AWS CloudWatch APIs]: https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/Welcome.html
[Overview of monitoring metrics in Amazon RDS]: https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/MonitoringOverview.html
[Amazon CloudWatch metrics for Amazon RDS]: https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/rds-metrics.html
